# AI代码审计任务执行框架

## 任务目标
作为专业的AI代码审计专家，您需要按照分阶段任务推进的方式，逐步完成整个项目的深度安全审计。每个阶段完成后，将在本框架中更新相应内容，最终形成完整的审计报告。

## ⚡ **核心执行要求**

### **全面性要求**
1. **方法级追踪**：如果一个方法存在漏洞，必须追踪所有调用该方法的上游路径
2. **端点完全枚举**：每个漏洞类型的所有攻击端点必须全部列出，不得合并
3. **参数全覆盖**：同一端点的不同漏洞参数要分别测试和报告

### 核心要求
**1.除了阶段一以外，所有的阶段任务执行完后，都要单独输出一份阶段的报告，阶段一的任务结果必须更新到代码审计.md中**  
**2.执行阶段任务一定要全面，避免任何遗漏的问题上线上产，所有路由、方法都必须检查，（若存在多个情况下）禁止只展示一个示例**  
**3.代码审计中发现的漏洞，除了硬编码这类，都要给出完整的路由和raw格式的http数据包，以便复现**  
**4.审计结果禁止`可能` `如果`这类字眼，一定要确保真实性，不要猜测漏洞的存在，要根据代码跟进进行确认**  
**5.要确保raw格式的http的poc数据包的准确性，审计完，确认漏洞，给出数据包后，需要进行二次或更多次的重复确认，避免出现误报**  
**6.组件漏洞要配合代码去审计，找出哪里有调用，找出漏洞接口**

### **HTTP数据包规范**
对于每个漏洞点，必须提供：
```
[方法] [完整URL] HTTP/1.1  
Host: [目标域名]  
[所有必要Header]  
[完整的请求体]

示例：  
POST /api/user/update HTTP/1.1  
Host: [target.com](https://target.com/)  
Content-Type: application/json  
Authorization: Bearer [token]  
Cookie: session=[session_id]

{  
"user_id": "[SQLI_PAYLOAD]",  
"username": "[XSS_PAYLOAD]",  
"role": "admin"  
}
```

### **越权分析要求**
- **认证状态**：明确标注"鉴权"或"未授权"
- **越权类型**：详细说明水平越权/垂直越权具体表现
- **权限要求**：说明触发漏洞所需的最小权限

### **阶段报告规范**
- 要求有标题，标明什么阶段什么任务类型
- 要求有审计范围覆盖情况
- 要求有漏洞详情（如果存在漏洞）
- 要求有漏洞汇总，标明漏洞统计、漏洞列表和漏洞影响范围

## 阶段划分与任务清单

### 📋 **阶段一：项目架构理解与映射** [待完成]
**任务目标**：全面理解项目技术架构、路由机制和数据流

**具体任务**：
- [ ] 识别项目技术栈和核心框架
- [ ] 分析项目目录结构和模块划分
- [ ] 梳理所有API路由和端点映射
- [ ] 理解认证授权架构（JWT/Session/OAuth等）
- [ ] 分析数据流和关键业务逻辑
- [ ] 识别所有用户输入点和数据出口

**输出要求**：
- 技术架构图（文字描述）
- 完整的路由端点清单
- 认证授权机制说明
- 数据流分析报告

---

### 💥 **阶段二：RCE漏洞深度审计** [待完成]
**审计范围**：
- 远程命令执行（系统命令注入）
- 代码注入（eval、动态函数执行等）
- 反序列化RCE
- 模板注入RCE
- 表达式语言注入
- 动态代码加载漏洞

**任务要求**：
- [ ] 识别所有命令执行函数调用点（exec、system、popen等）
- [ ] 分析所有代码执行函数（eval、assert、Function构造器等）
- [ ] 检查所有反序列化操作点
- [ ] 识别模板引擎的代码执行能力
- [ ] 分析表达式语言执行点（OGNL、SpEL、MVEL等）
- [ ] 检查动态类加载和反射调用
- [ ] 为每个RCE漏洞点找到所有可触发的URL端点
- [ ] 生成每个端点的完整HTTP攻击数据包

---

### 🔍 **阶段三：注入类漏洞深度审计** [待完成]
**审计范围**：
- SQL注入（所有数据库操作点）
- NoSQL注入
- 命令注入
- LDAP注入
- 模板注入

**任务要求**：
- [ ] 枚举所有数据库查询操作点
- [ ] 识别所有命令执行函数调用点
- [ ] 分析所有模板渲染位置
- [ ] 为每个漏洞点找到所有可触发的URL端点
- [ ] 生成每个端点的完整HTTP攻击数据包

---

### 🌐 **阶段四：XSS漏洞全面扫描** [待完成]
**审计范围**：
- 反射型XSS
- 存储型XSS  
- DOM型XSS

**任务要求**：
- [ ] 识别所有用户输入输出点
- [ ] 分析前端渲染机制
- [ ] 检查所有数据存储和检索点
- [ ] 枚举所有可触发XSS的URL和参数
- [ ] 提供完整的攻击HTTP数据包

---

### 🔐 **阶段五：认证与会话安全审计** [待完成]
**审计范围**：
- 弱密码策略
- 会话固定
- 未授权访问
- 暴力破解漏洞
- JWT安全问题

**任务要求**：
- [ ] 分析认证流程所有环节
- [ ] 检查会话管理机制
- [ ] 验证权限验证完整性
- [ ] 枚举所有可能绕过认证的端点

---

### 🚫 **阶段六：授权与访问控制审计** [待完成]
**审计范围**：
- 水平越权
- 垂直越权
- 权限提升
- 功能级访问控制缺失

**任务要求**：
- [ ] 分析所有需要权限的接口
- [ ] 测试不同权限用户的访问差异
- [ ] 识别所有可能越权的数据操作点
- [ ] 枚举所有越权攻击向量

---

### ⚙ **阶段七：配置与组件安全审计** [待完成]
**审计范围**：
- 敏感信息泄露
- CORS配置错误
- 调试模式开启
- 不安全反序列化
- 第三方组件漏洞

**任务要求**：
- [ ] 检查所有配置文件
- [ ] 分析依赖组件安全状况
- [ ] 识别信息泄露点
- [ ] 提供组件升级建议

---

### 📁 **阶段八：文件操作安全审计** [待完成]
**审计范围**：
- 任意文件上传
- 任意文件下载/读取
- 路径遍历
- 文件包含漏洞

**任务要求**：
- [ ] 分析所有文件操作功能
- [ ] 检查文件类型验证机制
- [ ] 识别路径拼接操作
- [ ] 枚举所有文件相关攻击端点

---

### 💼 **阶段九：业务逻辑漏洞审计** [待完成]
**审计范围**：
- 流程绕过
- 竞争条件
- 金额/数量篡改
- 业务规则绕过

**任务要求**：
- [ ] 分析核心业务逻辑
- [ ] 检查关键操作顺序
- [ ] 识别可能的状态机绕过
- [ ] 枚举业务逻辑漏洞利用点

---

## 📊 **阶段十：综合报告生成** [待完成]
**任务要求**：
- [ ] 整合各阶段审计结果
- [ ] 生成结构化漏洞报告
- [ ] 提供详细修复建议
- [ ] 进行风险评估和优先级排序

---

## 🎯 **阶段十一：质量保证与验证** [待完成]
**任务要求**：
- [ ] 全面性验证（确认100%代码覆盖）
- [ ] 准确性审查（消除误报）
- [ ] 漏洞组合利用分析
- [ ] 最终报告完整性检查

---

## 📋 **审计进度追踪**
已完成阶段：无

---

 
